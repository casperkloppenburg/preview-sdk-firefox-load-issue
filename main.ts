import { Preview } from '@creatomate/preview';

import './style.css';

let preview: Preview | undefined;

let testStarted = false;

document.addEventListener('DOMContentLoaded', function() {
  preview = new Preview(document.querySelector('#container'), 'player', 'public-7p7n35m68yzvbgrug2gfamfo');

  preview.onPlay = async () => {

    // Only run this once
    if (!testStarted) {
      testStarted = true;
    } else {
      return;
    }

    // Wait 2 seconds
    await new Promise(resolve => setTimeout(resolve, 2000));

    // Pause the video
    await preview.pause();

    // Swap video
    await preview.setModifications({
      'Video 1': 'https://creatomate-static.s3.us-west-2.amazonaws.com/video1_for_campaign_49.mp4',
    });

    // Continue playing (expecting loading to get stuck)
    await preview.play();
  };

  preview.onReady = async () => {
    await preview.setSource({
      'output_format': 'mp4',
      'width': 1080,
      'height': 1080,
      'duration': 19.04,
      'snapshot_time': 1,
      'elements': [
        {
          'id': '967db477-b724-40c0-a849-cec5abce6acf',
          'type': 'composition',
          'track': 1,
          'time': 0,
          'duration': 16,
          'elements': [
            {
              'id': 'abb8567c-93a4-46c0-838d-ada4ac6763bf',
              'name': 'Video 1',
              'type': 'video',
              'track': 1,
              'time': 0,
              'duration': 4,
              'dynamic': true,
              'source': 'ef8fe36b-2e81-4495-abe8-9d6d2e8c8f1e',
            },
            {
              'id': '76f24f9c-f09c-45e8-9432-7f39464018a3',
              'name': 'Video 2',
              'type': 'video',
              'track': 1,
              'time': 3,
              'duration': 5,
              'dynamic': true,
              'animations': [
                {
                  'time': 0,
                  'duration': 1,
                  'transition': true,
                  'type': 'fade',
                },
              ],
              'source': 'e49499d0-f8a2-4d3d-aca5-29d43a655ac7',
            },
            {
              'id': 'a701225d-e513-4f78-b9c6-06195ecf8f65',
              'name': 'Video 3',
              'type': 'video',
              'track': 1,
              'time': 7,
              'duration': 5,
              'dynamic': true,
              'animations': [
                {
                  'time': 0,
                  'duration': 1,
                  'transition': true,
                  'type': 'fade',
                },
              ],
              'source': '6dc8d8be-e648-41a6-9244-bcce4274e30d',
            },
            {
              'id': '9d663304-2099-4126-9132-e712764c6367',
              'name': 'Video 4',
              'type': 'video',
              'track': 1,
              'time': 11,
              'dynamic': true,
              'animations': [
                {
                  'time': 0,
                  'duration': 1,
                  'transition': true,
                  'type': 'fade',
                },
              ],
              'source': '7e81c571-7d2c-46b4-b261-919679bb41b5',
            },
            {
              'id': 'b09742f0-cab3-4e82-a5f2-e43d2d1da3a5',
              'name': 'Description',
              'type': 'text',
              'track': 2,
              'time': 0,
              'dynamic': true,
              'x': '3.743%',
              'y': '93.5601%',
              'width': '88.031%',
              'height': '18.9311%',
              'x_anchor': '0%',
              'y_anchor': '100%',
              'y_alignment': '50%',
              'fill_color': 'rgba(0,0,0,1)',
              'animations': [
                {
                  'time': 0,
                  'duration': 0.8,
                  'easing': 'quadratic-out',
                  'type': 'text-slide',
                  'scope': 'split-clip',
                  'split': 'line',
                  'overlap': '100%',
                  'direction': 'up',
                  'background_effect': 'scaling-clip',
                },
              ],
              'text': 'Los Angeles, CA 90045\nCall (123) 555-1234 to arrange a viewing today',
              'font_family': 'Montserrat',
              'font_weight': '800',
              'line_height': '234%',
              'background_color': 'rgba(255,255,255,1)',
              'background_x_padding': '73%',
              'background_y_padding': '35%',
              'background_align_threshold': '0%',
            },
            {
              'id': '4c3c5ed4-e904-4152-8f3d-17b539462cd0',
              'type': 'text',
              'track': 3,
              'time': 0,
              'x': '3.743%',
              'y': '71.7983%',
              'x_anchor': '0%',
              'y_anchor': '100%',
              'fill_color': 'rgba(255,255,255,1)',
              'animations': [
                {
                  'time': 0,
                  'duration': 0.8,
                  'easing': 'quadratic-out',
                  'type': 'text-slide',
                  'scope': 'split-clip',
                  'split': 'line',
                  'direction': 'up',
                  'background_effect': 'scaling-clip',
                },
              ],
              'text': 'Just Listed',
              'font_family': 'Montserrat',
              'font_weight': '800',
              'font_size': '3.5 vmin',
              'font_size_maximum': '4 vmin',
              'letter_spacing': '93%',
              'text_transform': 'uppercase',
              'background_color': 'rgba(0,0,0,1)',
              'background_x_padding': '73%',
              'background_y_padding': '35%',
            },
            {
              'id': '92500629-e52d-44fb-a1ea-b46a4aabc9ad',
              'name': 'Brand',
              'type': 'composition',
              'track': 4,
              'time': 0,
              'x': '3.743 vmax',
              'y': '3.6225 vmax',
              'width': '24.0286 vmax',
              'height': '6.4999 vmax',
              'aspect_ratio': 3.6757,
              'x_anchor': '0%',
              'y_anchor': '0%',
              'x_alignment': '0%',
              'clip': true,
              'elements': [
                {
                  'id': 'ba7cdeec-2f47-432b-8cac-cd597b3c8083',
                  'name': 'Logo',
                  'type': 'shape',
                  'track': 1,
                  'time': 0,
                  'x': '0%',
                  'y': '-0.0005%',
                  'width': '23.4707%',
                  'height': '100%',
                  'aspect_ratio': 0.8597,
                  'x_anchor': '0%',
                  'y_anchor': '0%',
                  'fill_color': 'rgba(255,255,255,1)',
                  'path': 'M 58.1602 0 L 0 0 L 0 100 L 58.1602 100 L 58.1602 0 Z M 58.1602 85.9694 C 35.0682 85.9694 16.3204 69.8521 16.3204 50 C 16.3204 30.1479 35.0682 14.0306 58.1602 14.0306 L 58.1602 85.9694 Z M 58.1602 13.8937 C 81.2522 13.8938 100 30.0118 100 49.8639 C 100 69.716 81.2522 85.8333 58.1602 85.8333 L 58.1602 13.8937 Z',
                },
                {
                  'id': '6619f96e-cf48-4e4a-a7bd-e410009887ed',
                  'type': 'text',
                  'track': 2,
                  'time': 0,
                  'x': '30.6628%',
                  'y': '17.1673%',
                  'width': '67.1571%',
                  'height': '65.6644%',
                  'x_anchor': '0%',
                  'y_anchor': '0%',
                  'y_alignment': '50%',
                  'fill_color': 'rgba(255,255,255,1)',
                  'text': 'My Brand',
                  'font_family': 'Inter',
                  'font_weight': '600',
                  'letter_spacing': '-25%',
                },
              ],
            },
          ],
        },
        {
          'id': 'db81cbec-d8db-4bd9-8e64-db8180f85e2b',
          'name': 'Outro',
          'type': 'composition',
          'track': 1,
          'time': 15,
          'duration': 4.04,
          'fill_color': 'rgba(255,255,255,1)',
          'animations': [
            {
              'time': 0,
              'duration': 1,
              'transition': true,
              'type': 'fade',
            },
          ],
          'elements': [
            {
              'id': '9d56117d-6915-4666-ab06-72a695cae8a9',
              'name': 'Picture',
              'type': 'image',
              'track': 1,
              'time': 0,
              'dynamic': true,
              'x': '-9.818%',
              'y': '107.5272%',
              'width': '109.818 vmax',
              'height': '49.8402 vmax',
              'aspect_ratio': 1,
              'x_anchor': '0%',
              'y_anchor': '100%',
              'x_alignment': '0%',
              'y_alignment': '100%',
              'border_radius': '100 vmax',
              'source': '08322d05-9717-402a-b267-5f49fb511f95',
            },
            {
              'id': '230d44fd-76fb-438d-9e10-3d4db45c4526',
              'type': 'composition',
              'track': 2,
              'time': 0,
              'duration': 4.04,
              'x': '95.5514%',
              'y': '6.1628%',
              'width': '91.1027 vmin',
              'height': '51.3513 vmin',
              'x_anchor': '100%',
              'y_anchor': '0%',
              'elements': [
                {
                  'id': '25001c94-deb3-4e1b-ad1e-ebc7ca5bb6c6',
                  'name': 'Contact Information',
                  'type': 'composition',
                  'track': 1,
                  'time': 0,
                  'duration': 4.04,
                  'x': '0%',
                  'y': '89.0197%',
                  'width': '99.5313%',
                  'height': '31.4584%',
                  'x_anchor': '0%',
                  'y_anchor': '100%',
                  'elements': [
                    {
                      'id': '14ddd1c6-c9e6-4520-b35d-cf7746050716',
                      'name': 'Email Icon',
                      'type': 'shape',
                      'track': 1,
                      'time': 0,
                      'x': '0%',
                      'y': '66.9823%',
                      'width': '5.593%',
                      'height': '28.7785%',
                      'aspect_ratio': 1,
                      'x_anchor': '0%',
                      'y_anchor': '0%',
                      'fill_color': '#000000',
                      'path': 'M 63.6362 31.8159 C 59.8358 28.9634 55.114 27.2695 50 27.2695 C 37.4561 27.2695 27.2725 37.4532 27.2725 49.9971 C 27.2725 62.5409 37.4561 72.7246 50 72.7246 C 56.7709 72.7246 62.8549 69.7571 67.0195 65.0529 C 70.3276 69.6819 75.7452 72.7246 81.8174 72.7246 C 91.7917 72.7246 100 64.5163 100 54.542 L 100 49.9971 C 99.9971 22.5683 77.4272 0 50 0 C 22.5713 0 0 22.5713 0 50 C 0 77.4287 22.5713 100 50 100 C 60.9886 100 71.6764 96.3779 80.3992 89.6969 C 82.3908 88.1711 82.7697 85.3156 81.2454 83.324 C 79.7196 81.3324 76.8641 80.9535 74.8725 82.4793 C 67.7345 87.9456 58.9896 90.9087 50 90.9087 C 27.5585 90.9087 9.0913 72.4415 9.0913 50 C 9.0913 27.5585 27.5585 9.0913 50 9.0913 C 72.4415 9.0913 90.9072 27.557 90.9087 49.9971 L 90.9087 54.542 C 90.9087 59.5291 86.8046 63.6333 81.8174 63.6333 C 76.8302 63.6333 72.7275 59.5291 72.7275 54.542 L 72.7275 31.8159 C 72.7275 29.3068 70.6902 27.2695 68.1811 27.2695 C 65.6736 27.2695 63.6362 29.3068 63.6362 31.8159 Z M 50 36.3608 C 57.5257 36.3608 63.6362 42.4713 63.6362 49.9971 C 63.6362 57.5228 57.5257 63.6333 50 63.6333 C 42.4743 63.6333 36.3638 57.5228 36.3638 49.9971 C 36.3638 42.4713 42.4743 36.3608 50 36.3608 Z',
                    },
                    {
                      'id': 'aac583bc-c318-4421-8c58-894aefe8ea5e',
                      'name': 'Email',
                      'type': 'text',
                      'track': 2,
                      'time': 0,
                      'dynamic': true,
                      'x': '9.0998%',
                      'y': '57.1175%',
                      'width': '90.9002%',
                      'height': '42.8825%',
                      'x_anchor': '0%',
                      'y_anchor': '0%',
                      'y_alignment': '50%',
                      'fill_color': 'rgba(0,0,0,1)',
                      'animations': [
                        {
                          'time': 0,
                          'duration': 1.24,
                          'easing': 'quadratic-out',
                          'type': 'text-slide',
                          'scope': 'split-clip',
                          'split': 'line',
                          'direction': 'up',
                          'background_effect': 'scaling-clip',
                        },
                      ],
                      'text': 'elisabeth@mybrand.com',
                      'font_family': 'Inter',
                      'background_border_radius': '39%',
                    },
                    {
                      'id': 'c67c8190-0aba-4bd4-9f0e-e598d6806375',
                      'name': 'Phone Icon',
                      'type': 'shape',
                      'track': 3,
                      'time': 0,
                      'x': '0.0285%',
                      'y': '9.5946%',
                      'width': '5.5723%',
                      'height': '28.6986%',
                      'aspect_ratio': 0.9991,
                      'x_anchor': '0%',
                      'y_anchor': '0%',
                      'fill_color': '#000000',
                      'path': 'M 99.8624 72.6636 C 100 65.7836 94.9158 59.8114 88.09 58.849 C 84.0105 58.3109 80.0435 57.3234 76.2274 55.9013 C 71.2438 54.0298 65.5899 55.2346 61.7975 58.9821 L 58.5082 62.2683 C 50.0917 56.908 42.9508 49.7738 37.5855 41.3653 L 40.8748 38.0791 C 44.6258 34.2903 45.8317 28.6418 43.9555 23.6525 C 42.535 19.8504 41.5466 15.8871 41.0139 11.8529 C 40.0521 5.0572 34.1777 0 27.3534 0.0503 L 13.6752 0.0503 C 6.1703 0.0577 0 6.228 0 13.7244 C 0 14.1354 0.0192 14.5463 0.0562 14.9558 C 1.6351 29.8199 6.6734 44.0381 14.7658 56.5251 C 22.1257 68.0898 31.9405 77.8952 43.516 85.2482 C 55.9587 93.3049 70.1193 98.3355 84.8614 99.9364 C 85.3526 99.9823 85.764 100 86.1753 100 C 93.6832 100 99.8624 93.8267 99.8624 86.3259 L 99.8624 72.6636 Z M 90.7387 72.5024 L 90.7372 86.3259 C 90.7372 88.8257 88.6775 90.8834 86.1753 90.8834 L 85.8379 90.8716 C 72.4853 89.4155 59.6978 84.8668 48.4626 77.5877 C 37.9702 70.9251 29.1024 62.0672 22.4572 51.6187 C 15.1283 40.3158 10.5738 27.4857 9.1444 14.1339 C 9.1311 13.9801 9.1252 13.7244 9.1252 13.7244 C 9.1252 11.2261 11.182 9.1698 13.6826 9.1668 L 27.4111 9.1668 C 29.681 9.1447 31.6371 10.8166 31.9686 13.0577 C 32.596 17.7823 33.7486 22.4034 35.4103 26.8501 C 36.0362 28.5161 35.6411 30.3891 34.4041 31.653 L 28.6112 37.4405 C 27.1581 38.8907 26.8563 41.1318 27.8713 42.9161 C 34.7711 55.0395 44.8211 65.08 56.956 71.9732 C 58.742 72.9873 60.9852 72.6857 62.4367 71.2341 L 68.2179 65.4584 C 69.483 64.2137 71.3652 63.8131 73.0268 64.4384 C 77.4881 66.1015 82.1136 67.2531 86.8234 67.8769 C 89.1021 68.2021 90.7964 70.2022 90.7387 72.5024 Z',
                    },
                    {
                      'id': '8d5555fd-9623-49e8-b7a8-9c93033dbba9',
                      'name': 'Phone Number',
                      'type': 'text',
                      'track': 4,
                      'time': 0,
                      'dynamic': true,
                      'x': '9.0998%',
                      'y': '0%',
                      'width': '90.9002%',
                      'height': '42.8825%',
                      'x_anchor': '0%',
                      'y_anchor': '0%',
                      'y_alignment': '50%',
                      'fill_color': 'rgba(0,0,0,1)',
                      'animations': [
                        {
                          'time': 0,
                          'duration': 1.24,
                          'easing': 'quadratic-out',
                          'type': 'text-slide',
                          'scope': 'split-clip',
                          'split': 'line',
                          'direction': 'up',
                          'background_effect': 'scaling-clip',
                        },
                      ],
                      'text': '(123) 555-1234',
                      'font_family': 'Inter',
                    },
                  ],
                },
                {
                  'id': 'cb581572-7974-4245-a0d5-a24760360e86',
                  'name': 'Brand Name',
                  'type': 'text',
                  'track': 2,
                  'time': 0,
                  'dynamic': true,
                  'x': '0%',
                  'y': '42.0437%',
                  'width': '100%',
                  'height': '13.5977%',
                  'x_anchor': '0%',
                  'y_anchor': '100%',
                  'y_alignment': '100%',
                  'fill_color': 'rgba(0,0,0,1)',
                  'animations': [
                    {
                      'time': 0,
                      'duration': 1.24,
                      'easing': 'quadratic-out',
                      'type': 'text-slide',
                      'scope': 'split-clip',
                      'split': 'line',
                      'direction': 'up',
                      'background_effect': 'scaling-clip',
                    },
                  ],
                  'text': 'My Brand Realtors',
                  'font_family': 'Inter',
                  'background_border_radius': '39%',
                },
                {
                  'id': 'e4a99efd-5f3f-41e9-913e-fec61bf677cc',
                  'name': 'Name',
                  'type': 'text',
                  'track': 3,
                  'time': 0,
                  'dynamic': true,
                  'x': '0%',
                  'y': '26.2822%',
                  'width': '100%',
                  'height': '26.2822%',
                  'x_anchor': '0%',
                  'y_anchor': '100%',
                  'y_alignment': '100%',
                  'fill_color': 'rgba(0,0,0,1)',
                  'animations': [
                    {
                      'time': 0,
                      'duration': 1.24,
                      'easing': 'quadratic-out',
                      'type': 'text-slide',
                      'scope': 'split-clip',
                      'split': 'line',
                      'direction': 'up',
                      'background_effect': 'scaling-clip',
                    },
                  ],
                  'text': 'Elisabeth Parker',
                  'font_family': 'Inter',
                  'font_weight': '800',
                  'background_border_radius': '39%',
                },
              ],
            },
          ],
        },
      ],
    });
  };
});
